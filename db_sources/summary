Hola, Gemini. Vamos a iniciar un nuevo proyecto de software.

Mi Rol: Soy un desarrollador que necesita crear un proceso ETL.

El Objetivo: Necesito crear un proyecto ETL en Python. Este proyecto extraerá datos de una base de datos de origen (SQL Server), los transformará y los cargará en una bodega de datos (Data Warehouse) que también está en SQL Server.

Tecnologías:

Lenguaje: Python

Base de Datos (ambas): SQL Server

IDE: Visual Studio Code

Información de Origen (DDL de Tablas Fuente): Aquí están las definiciones (DDL) de las tablas de origen que usaremos.


--==================================================
-- Esquema: Person
-- Tablas base para DimCustomer
--==================================================
CREATE SCHEMA Person;
GO

CREATE TABLE AdventureWorks2022_TRANS.Person.BusinessEntity (
	BusinessEntityID int IDENTITY(1,1) NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_BusinessEntity_BusinessEntityID PRIMARY KEY (BusinessEntityID)
[cite_start]); [cite: 31]

CREATE TABLE AdventureWorks2022_TRANS.Person.AddressType (
	AddressTypeID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_AddressType_AddressTypeID PRIMARY KEY (AddressTypeID)
[cite_start]); [cite: 29]

CREATE TABLE AdventureWorks2022_TRANS.Person.CountryRegion (
	CountryRegionCode nvarchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_CountryRegion_CountryRegionCode PRIMARY KEY (CountryRegionCode)
[cite_start]); [cite: 35]

CREATE TABLE AdventureWorks2022_TRANS.Person.StateProvince (
	StateProvinceID int IDENTITY(1,1) NOT NULL,
	StateProvinceCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CountryRegionCode nvarchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	IsOnlyStateProvinceFlag Flag DEFAULT 1 NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	TerritoryID int NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_StateProvince_StateProvinceID PRIMARY KEY (StateProvinceID)
[cite_start]); [cite: 58]

CREATE TABLE AdventureWorks2022_TRANS.Person.Address (
	AddressID int IDENTITY(1,1) NOT NULL,
	AddressLine1 nvarchar(60) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	AddressLine2 nvarchar(60) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	City nvarchar(30) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	StateProvinceID int NOT NULL,
	PostalCode nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SpatialLocation geography NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Address_AddressID PRIMARY KEY (AddressID)
[cite_start]); [cite: 52]

CREATE TABLE AdventureWorks2022_TRANS.Person.BusinessEntityAddress (
	BusinessEntityID int NOT NULL,
	AddressID int NOT NULL,
	AddressTypeID int NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_BusinessEntityAddress_BusinessEntityID_AddressID_AddressTypeID PRIMARY KEY (BusinessEntityID,AddressID,AddressTypeID)
[cite_start]); [cite: 55]

CREATE TABLE AdventureWorks2022_TRANS.Person.Person (
	BusinessEntityID int NOT NULL,
	PersonType nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	NameStyle NameStyle DEFAULT 0 NOT NULL,
	Title nvarchar(8) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FirstName Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MiddleName Name COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	LastName Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Suffix nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmailPromotion int DEFAULT 0 NOT NULL,
	AdditionalContactInfo xml NULL,
	Demographics xml NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Person_BusinessEntityID PRIMARY KEY (BusinessEntityID)
[cite_start]); [cite: 38]

CREATE TABLE AdventureWorks2022_TRANS.Person.PhoneNumberType (
	PhoneNumberTypeID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_PhoneNumberType_PhoneNumberTypeID PRIMARY KEY (PhoneNumberTypeID)
[cite_start]); [cite: 37]

CREATE TABLE AdventureWorks2022_TRANS.Person.PersonPhone (
	BusinessEntityID int NOT NULL,
	PhoneNumber Phone COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	PhoneNumberTypeID int NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_PersonPhone_BusinessEntityID_PhoneNumber_PhoneNumberTypeID PRIMARY KEY (BusinessEntityID,PhoneNumber,PhoneNumberTypeID)
[cite_start]); [cite: 44]

CREATE TABLE AdventureWorks2022_TRANS.Person.EmailAddress (
	BusinessEntityID int NOT NULL,
	EmailAddressID int IDENTITY(1,1) NOT NULL,
	EmailAddress nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_EmailAddress_BusinessEntityID_EmailAddressID PRIMARY KEY (BusinessEntityID,EmailAddressID)
[cite_start]); [cite: 49]

--==================================================
-- Esquema: Production
-- Tablas base para DimProduct
--==================================================
CREATE SCHEMA Production;
GO

CREATE TABLE AdventureWorks2022_TRANS.Production.ProductCategory (
	ProductCategoryID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_ProductCategory_ProductCategoryID PRIMARY KEY (ProductCategoryID)
[cite_start]); [cite: 72]

CREATE TABLE AdventureWorks2022_TRANS.Production.ProductSubcategory (
	ProductSubcategoryID int IDENTITY(1,1) NOT NULL,
	ProductCategoryID int NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_ProductSubcategory_ProductSubcategoryID PRIMARY KEY (ProductSubcategoryID)
[cite_start]); [cite: 89]

CREATE TABLE AdventureWorks2022_TRANS.Production.UnitMeasure (
	UnitMeasureCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_UnitMeasure_UnitMeasureCode PRIMARY KEY (UnitMeasureCode)
[cite_start]); [cite: 85]

CREATE TABLE AdventureWorks2022_TRANS.Production.ProductModel (
	ProductModelID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CatalogDescription xml NULL,
	Instructions xml NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_ProductModel_ProductModelID PRIMARY KEY (ProductModelID)
[cite_start]); [cite: 76]

CREATE TABLE AdventureWorks2022_TRANS.Production.ProductDescription (
	ProductDescriptionID int IDENTITY(1,1) NOT NULL,
	Description nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_ProductDescription_ProductDescriptionID PRIMARY KEY (ProductDescriptionID)
[cite_start]); [cite: 74]

CREATE TABLE AdventureWorks2022_TRANS.Production.Culture (
	CultureID nchar(6) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Culture_CultureID PRIMARY KEY (CultureID)
[cite_start]); [cite: 66]

CREATE TABLE AdventureWorks2022_TRANS.Production.ProductModelProductDescriptionCulture (
	ProductModelID int NOT NULL,
	ProductDescriptionID int NOT NULL,
	CultureID nchar(6) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_ProductModelProductDescriptionCulture_ProductModelID_ProductDescriptionID_CultureID PRIMARY KEY (ProductModelID,ProductDescriptionID,CultureID)
[cite_start]); [cite: 88]

CREATE TABLE AdventureWorks2022_TRANS.Production.Product (
	ProductID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ProductNumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MakeFlag Flag DEFAULT 1 NOT NULL,
	FinishedGoodsFlag Flag DEFAULT 1 NOT NULL,
	Color nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SafetyStockLevel smallint NOT NULL,
	ReorderPoint smallint NOT NULL,
	StandardCost money NOT NULL,
	ListPrice money NOT NULL,
	[Size] nvarchar(5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SizeUnitMeasureCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	WeightUnitMeasureCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Weight decimal(8,2) NULL,
	DaysToManufacture int NOT NULL,
	ProductLine nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Class nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[Style] nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ProductSubcategoryID int NULL,
	ProductModelID int NULL,
	SellStartDate datetime NOT NULL,
	SellEndDate datetime NULL,
	DiscontinuedDate datetime NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Product_ProductID PRIMARY KEY (ProductID)
[cite_start]); [cite: 91, 92]

--==================================================
-- Esquema: Sales
-- Tablas base para FactInternetSales y Dimensiones
--==================================================
CREATE SCHEMA Sales;
GO

CREATE TABLE AdventureWorks2022_TRANS.Sales.Currency (
	CurrencyCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Currency_CurrencyCode PRIMARY KEY (CurrencyCode)
[cite_start]); [cite: 172]

CREATE TABLE AdventureWorks2022_TRANS.Sales.CurrencyRate (
	CurrencyRateID int IDENTITY(1,1) NOT NULL,
	CurrencyRateDate datetime NOT NULL,
	FromCurrencyCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ToCurrencyCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	AverageRate money NOT NULL,
	EndOfDayRate money NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_CurrencyRate_CurrencyRateID PRIMARY KEY (CurrencyRateID)
[cite_start]); [cite: 179]

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesTerritory (
	TerritoryID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CountryRegionCode nvarchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[Group] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesYTD money DEFAULT 0.00 NOT NULL,
	SalesLastYear money DEFAULT 0.00 NOT NULL,
	CostYTD money DEFAULT 0.00 NOT NULL,
	CostLastYear money DEFAULT 0.00 NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_SalesTerritory_TerritoryID PRIMARY KEY (TerritoryID)
[cite_start]); [cite: 209]

CREATE TABLE AdventureWorks2022_TRANS.Sales.Customer (
	CustomerID int IDENTITY(1,1) NOT NULL,
	PersonID int NULL,
	StoreID int NULL,
	TerritoryID int NULL,
	AccountNumber AS (isnull('AW'+[dbo].[ufnLeadingZeros]([CustomerID]),'')) NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_Customer_CustomerID PRIMARY KEY (CustomerID)
[cite_start]); [cite: 183]

CREATE TABLE AdventureWorks2022_TRANS.Sales.SpecialOffer (
	SpecialOfferID int IDENTITY(1,1) NOT NULL,
	Description nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	DiscountPct smallmoney DEFAULT 0.00 NOT NULL,
	[Type] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Category nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	StartDate datetime NOT NULL,
	EndDate datetime NOT NULL,
	MinQty int DEFAULT 0 NOT NULL,
	MaxQty int NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_SpecialOffer_SpecialOfferID PRIMARY KEY (SpecialOfferID)
[cite_start]); [cite: 175]

CREATE TABLE AdventureWorks2022_TRANS.Sales.SpecialOfferProduct (
	SpecialOfferID int NOT NULL,
	ProductID int NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_SpecialOfferProduct_SpecialOfferID_ProductID PRIMARY KEY (SpecialOfferID,ProductID)
[cite_start]); [cite: 217]

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesOrderHeader (
	SalesOrderID int IDENTITY(1,1) NOT NULL,
	RevisionNumber tinyint DEFAULT 0 NOT NULL,
	OrderDate datetime DEFAULT getdate() NOT NULL,
	DueDate datetime NOT NULL,
	ShipDate datetime NULL,
	Status tinyint DEFAULT 1 NOT NULL,
	OnlineOrderFlag Flag DEFAULT 1 NOT NULL,
	SalesOrderNumber AS (isnull(N'SO'+CONVERT([nvarchar](23),[SalesOrderID]),N'*** ERROR ***')) NOT NULL,
	PurchaseOrderNumber OrderNumber COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AccountNumber AccountNumber COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CustomerID int NOT NULL,
	SalesPersonID int NULL,
	TerritoryID int NULL,
	BillToAddressID int NOT NULL,
	ShipToAddressID int NOT NULL,
	ShipMethodID int NOT NULL,
	CreditCardID int NULL,
	CreditCardApprovalCode varchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CurrencyRateID int NULL,
	SubTotal money DEFAULT 0.00 NOT NULL,
	TaxAmt money DEFAULT 0.00 NOT NULL,
	Freight money DEFAULT 0.00 NOT NULL,
	TotalDue AS (isnull(([SubTotal]+[TaxAmt])+[Freight],(0))) NOT NULL,
	Comment nvarchar(128) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_SalesOrderHeader_SalesOrderID PRIMARY KEY (SalesOrderID)
[cite_start]); [cite: 191, 192]

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesOrderDetail (
	SalesOrderID int NOT NULL,
	SalesOrderDetailID int IDENTITY(1,1) NOT NULL,
	CarrierTrackingNumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	OrderQty smallint NOT NULL,
	ProductID int NOT NULL,
	SpecialOfferID int NOT NULL,
	UnitPrice money NOT NULL,
	UnitPriceDiscount money DEFAULT 0.0 NOT NULL,
	LineTotal AS (isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))) NOT NULL,
	rowguid uniqueidentifier DEFAULT newid() NOT NULL,
	ModifiedDate datetime DEFAULT getdate() NOT NULL,
	CONSTRAINT PK_SalesOrderDetail_SalesOrderID_SalesOrderDetailID PRIMARY KEY (SalesOrderID,SalesOrderDetailID)
[cite_start]); [cite: 187]




Información de Destino (DDL del Data Warehouse): Aquí están las definiciones (DDL) de las tablas de hechos y dimensiones de destino.

--==================================================
-- Creación de Dimensiones
--==================================================

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimDate (
	DateKey int NOT NULL,
	FullDateAlternateKey date NOT NULL,
	DayNumberOfWeek tinyint NOT NULL,
	EnglishDayNameOfWeek nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SpanishDayNameOfWeek nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	FrenchDayNameOfWeek nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	DayNumberOfMonth tinyint NOT NULL,
	DayNumberOfYear smallint NOT NULL,
	WeekNumberOfYear tinyint NOT NULL,
	EnglishMonthName nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SpanishMonthName nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	FrenchMonthName nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MonthNumberOfYear tinyint NOT NULL,
	CalendarQuarter tinyint NOT NULL,
	CalendarYear smallint NOT NULL,
	CalendarSemester tinyint NOT NULL,
	FiscalQuarter tinyint NOT NULL,
	FiscalYear smallint NOT NULL,
	FiscalSemester tinyint NOT NULL,
	CONSTRAINT PK_DimDate_DateKey PRIMARY KEY (DateKey)
[cite_start]); [cite: 261]

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimCurrency (
	CurrencyKey int IDENTITY(1,1) NOT NULL,
	CurrencyAlternateKey nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CurrencyName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CONSTRAINT PK_DimCurrency_CurrencyKey PRIMARY KEY (CurrencyKey)
[cite_start]); [cite: 263]

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimCustomer (
	CustomerKey int IDENTITY(1,1) NOT NULL,
	GeographyKey int NULL,
	CustomerAlternateKey nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Title nvarchar(8) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FirstName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	MiddleName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	LastName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	NameStyle bit NULL,
	BirthDate date NULL,
	MaritalStatus nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Suffix nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Gender nvarchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmailAddress nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	YearlyIncome money NULL,
	TotalChildren tinyint NULL,
	NumberChildrenAtHome tinyint NULL,
	EnglishEducation nvarchar(40) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SpanishEducation nvarchar(40) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchEducation nvarchar(40) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EnglishOccupation nvarchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SpanishOccupation nvarchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchOccupation nvarchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	HouseOwnerFlag nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	NumberCarsOwned tinyint NULL,
	AddressLine1 nvarchar(120) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AddressLine2 nvarchar(120) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Phone nvarchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DateFirstPurchase date NULL,
	CommuteDistance nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CONSTRAINT PK_DimCustomer_CustomerKey PRIMARY KEY (CustomerKey)
[cite_start]); [cite: 265, 266]

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimProduct (
	ProductKey int IDENTITY(1,1) NOT NULL,
	ProductAlternateKey nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ProductSubcategoryKey int NULL,
	WeightUnitMeasureCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SizeUnitMeasureCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EnglishProductName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SpanishProductName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	FrenchProductName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	StandardCost money NULL,
	FinishedGoodsFlag bit NOT NULL,
	Color nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SafetyStockLevel smallint NULL,
	ReorderPoint smallint NULL,
	ListPrice money NULL,
	[Size] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SizeRange nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Weight float NULL,
	DaysToManufacture int NULL,
	ProductLine nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DealerPrice money NULL,
	Class nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[Style] nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ModelName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	LargePhoto varbinary(MAX) NULL,
	EnglishDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ChineseDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ArabicDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	HebrewDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ThaiDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	GermanDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	JapaneseDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TurkishDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	StartDate datetime NULL,
	EndDate datetime NULL,
	Status nvarchar(7) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CONSTRAINT PK_DimProduct_ProductKey PRIMARY KEY (ProductKey)
[cite_start]); [cite: 269, 270]

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimPromotion (
	PromotionKey int IDENTITY(1,1) NOT NULL,
	PromotionAlternateKey int NULL,
	EnglishPromotionName nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SpanishPromotionName nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchPromotionName nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DiscountPct float NULL,
	EnglishPromotionType nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SpanishPromotionType nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchPromotionType nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EnglishPromotionCategory nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SpanishPromotionCategory nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FrenchPromotionCategory nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	StartDate datetime NOT NULL,
	EndDate datetime NULL,
	MinQty int NULL,
	MaxQty int NULL,
	CONSTRAINT PK_DimPromotion_PromotionKey PRIMARY KEY (PromotionKey)
[cite_start]); [cite: 272]

--==================================================
-- Creación de Tabla de Hechos (Fact)
--==================================================

CREATE TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales (
	ProductKey int NOT NULL,
	OrderDateKey int NOT NULL,
	DueDateKey int NOT NULL,
	ShipDateKey int NOT NULL,
	CustomerKey int NOT NULL,
	PromotionKey int NOT NULL,
	CurrencyKey int NOT NULL,
	SalesTerritoryKey int NOT NULL,
	SalesOrderNumber nvarchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesOrderLineNumber tinyint NOT NULL,
	RevisionNumber tinyint NOT NULL,
	OrderQuantity smallint NOT NULL,
	UnitPrice money NOT NULL,
	ExtendedAmount money NOT NULL,
	UnitPriceDiscountPct float NOT NULL,
	DiscountAmount float NOT NULL,
	ProductStandardCost money NOT NULL,
	TotalProductCost money NOT NULL,
	SalesAmount money NOT NULL,
	TaxAmt money NOT NULL,
	Freight money NOT NULL,
	CarrierTrackingNumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CustomerPONumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	OrderDate datetime NULL,
	DueDate datetime NULL,
	ShipDate datetime NULL,
	CONSTRAINT PK_FactInternetSales_SalesOrderNumber_SalesOrderLineNumber PRIMARY KEY (SalesOrderNumber,SalesOrderLineNumber)
[cite_start]); [cite: 252]

--==================================================
-- Definición de Claves Foráneas (FKs) de la Bodega
--==================================================

[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimCurrency FOREIGN KEY (CurrencyKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimCurrency(CurrencyKey); [cite: 253]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimCustomer FOREIGN KEY (CustomerKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimCustomer(CustomerKey); [cite: 254]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimDate FOREIGN KEY (OrderDateKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimDate(DateKey); [cite: 255]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimDate1 FOREIGN KEY (DueDateKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimDate(DateKey); [cite: 256]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimDate2 FOREIGN KEY (ShipDateKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimDate(DateKey); [cite: 257]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimProduct FOREIGN KEY (ProductKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimProduct(ProductKey); [cite: 258]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimPromotion FOREIGN KEY (PromotionKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimPromotion(PromotionKey); [cite: 259]
[cite_start]ALTER TABLE AdventureWorksDW2022_DW.dbo.FactInternetSales ADD CONSTRAINT FK_FactInternetSales_DimSalesTerritory FOREIGN KEY (SalesTerritoryKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimSalesTerritory(SalesTerritoryKey); [cite: 260]

-- Nota: El archivo no incluía DimGeography ni DimProductSubcategory, 
-- pero las FK de DimCustomer y DimProduct apuntan a ellas.
[cite_start]-- ALTER TABLE AdventureWorksDW2022_DW.dbo.DimCustomer ADD CONSTRAINT FK_DimCustomer_DimGeography FOREIGN KEY (GeographyKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimGeography(GeographyKey); [cite: 268]
[cite_start]-- ALTER TABLE AdventureWorksDW2022_DW.dbo.DimProduct ADD CONSTRAINT FK_DimProduct_DimProductSubcategory FOREIGN KEY (ProductSubcategoryKey) REFERENCES AdventureWorksDW2022_DW.dbo.DimProductSubcategory(ProductSubcategoryKey); [cite: 271]


-----
Mi Petición (Lo que necesito de ti):

Estructura del Proyecto: Genérame una estructura de carpetas y archivos recomendada para este proyecto ETL en Python, siguiendo las buenas prácticas.

crea un archivo unico de extract , load , transform y utils


Librerías: Recomiéndame las librerías de Python clave que necesitaré (por ejemplo, para la conexión a SQL Server, manipulación de datos, etc.).

Archivo de Conexión: Dame un ejemplo de un script de Python (ej. database.py) que gestione la conexión a SQL Server (usando pyodbc o sqlalchemy).

Archivo requirements.txt: Crea el contenido de un archivo requirements.txt con las librerías que me recomendaste.





















Hola, Gemini. Necesito actualizar mi proyecto ETL existente.

Situación Actual: Ya tengo un proyecto ETL en Python que extrae datos de la base de datos AdventureWorks2022_TRANS y carga las siguientes tablas en mi Data Warehouse:

FactInternetSales

DimProduct (y sus sub-tablas como DimProductSubcategory)

DimCustomer

DimDate

Mi proyecto ya tiene scripts funcionales para extraer, transformar y cargar DimProduct y DimDate.

Nueva Tarea: Necesito agregar una nueva tabla de hechos, FactResellerSales, y sus dimensiones asociadas.

Información de Origen (DDL de Tablas Fuente): Te proporciono el DDL completo de la base de datos de origen (AdventureWorks2022_TRANS) para que tengas todo el contexto de las tablas fuente.


/* --- TABLAS FUENTE PARA FactResellerSales --- */

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesOrderHeader (
	SalesOrderID int IDENTITY(1,1) NOT NULL,
	RevisionNumber tinyint DEFAULT 0 NOT NULL,
	OrderDate datetime DEFAULT getdate() NOT NULL,
	DueDate datetime NOT NULL,
	ShipDate datetime NULL,
	Status tinyint DEFAULT 1 NOT NULL,
	OnlineOrderFlag Flag DEFAULT 1 NOT NULL,
	SalesOrderNumber AS (isnull(N'SO'+CONVERT([nvarchar](23),[SalesOrderID]),N'*** ERROR ***')) NOT NULL,
	PurchaseOrderNumber OrderNumber COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AccountNumber AccountNumber COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CustomerID int NOT NULL,
	SalesPersonID int NULL,
	TerritoryID int NULL,
	BillToAddressID int NOT NULL,
	ShipToAddressID int NOT NULL,
	ShipMethodID int NOT NULL,
	CreditCardID int NULL,
	CreditCardApprovalCode varchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CurrencyRateID int NULL,
	SubTotal money DEFAULT 0.00 NOT NULL,
	TaxAmt money DEFAULT 0.00 NOT NULL,
	Freight money DEFAULT 0.00 NOT NULL,
	TotalDue AS (isnull(([SubTotal]+[TaxAmt])+[Freight],(0))) NOT NULL,
	CONSTRAINT PK_SalesOrderHeader_SalesOrderID PRIMARY KEY (SalesOrderID)
);

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesOrderDetail (
	SalesOrderID int NOT NULL,
	SalesOrderDetailID int IDENTITY(1,1) NOT NULL,
	CarrierTrackingNumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	OrderQty smallint NOT NULL,
	ProductID int NOT NULL,
	SpecialOfferID int NOT NULL,
	UnitPrice money NOT NULL,
	UnitPriceDiscount money DEFAULT 0.0 NOT NULL,
	LineTotal AS (isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))) NOT NULL,
	CONSTRAINT PK_SalesOrderDetail_SalesOrderID_SalesOrderDetailID PRIMARY KEY (SalesOrderID,SalesOrderDetailID)
);

/* --- TABLAS FUENTE PARA DimReseller --- */

CREATE TABLE AdventureWorks2022_TRANS.Sales.Store (
	BusinessEntityID int NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesPersonID int NULL,
	Demographics xml NULL,
	CONSTRAINT PK_Store_BusinessEntityID PRIMARY KEY (BusinessEntityID)
);

/* --- TABLAS FUENTE PARA DimEmployee --- */

CREATE TABLE AdventureWorks2022_TRANS.HumanResources.Employee (
	BusinessEntityID int NOT NULL,
	NationalIDNumber nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	LoginID nvarchar(256) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	JobTitle nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	BirthDate date NOT NULL,
	MaritalStatus nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Gender nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	HireDate date NOT NULL,
	SalariedFlag Flag DEFAULT 1 NOT NULL,
	VacationHours smallint DEFAULT 0 NOT NULL,
	SickLeaveHours smallint DEFAULT 0 NOT NULL,
	CurrentFlag Flag DEFAULT 1 NOT NULL,
	CONSTRAINT PK_Employee_BusinessEntityID PRIMARY KEY (BusinessEntityID)
);

CREATE TABLE AdventureWorks2022_TRANS.Person.Person (
	BusinessEntityID int NOT NULL,
	PersonType nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Title nvarchar(8) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FirstName Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MiddleName Name COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	LastName Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Suffix nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmailPromotion int DEFAULT 0 NOT NULL,
	CONSTRAINT PK_Person_BusinessEntityID PRIMARY KEY (BusinessEntityID)
);

/* --- TABLAS FUENTE PARA DimPromotion --- */

CREATE TABLE AdventureWorks2022_TRANS.Sales.SpecialOffer (
	SpecialOfferID int IDENTITY(1,1) NOT NULL,
	Description nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	DiscountPct smallmoney DEFAULT 0.00 NOT NULL,
	[Type] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Category nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	StartDate datetime NOT NULL,
	EndDate datetime NOT NULL,
	MinQty int DEFAULT 0 NOT NULL,
	MaxQty int NULL,
	CONSTRAINT PK_SpecialOffer_SpecialOfferID PRIMARY KEY (SpecialOfferID)
);

/* --- TABLAS FUENTE PARA DimCurrency --- */

CREATE TABLE AdventureWorks2022_TRANS.Sales.Currency (
	CurrencyCode nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CONSTRAINT PK_Currency_CurrencyCode PRIMARY KEY (CurrencyCode)
);

/* --- TABLAS FUENTE PARA DimSalesTerritory --- */

CREATE TABLE AdventureWorks2022_TRANS.Sales.SalesTerritory (
	TerritoryID int IDENTITY(1,1) NOT NULL,
	Name Name COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CountryRegionCode nvarchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[Group] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesYTD money DEFAULT 0.00 NOT NULL,
	SalesLastYear money DEFAULT 0.00 NOT NULL,
	CostYTD money DEFAULT 0.00 NOT NULL,
	CostLastYear money DEFAULT 0.00 NOT NULL,
	CONSTRAINT PK_SalesTerritory_TerritoryID PRIMARY KEY (TerritoryID)
);


Información de Destino (DDL del Nuevo DW): Aquí están las definiciones (DDL) de la nueva tabla de hechos FactResellerSales y todas las dimensiones que esta requiere.



/* --- NUEVA TABLA DE HECHOS --- */

CREATE TABLE AdventureWorksDW2022_DW.dbo.FactResellerSales (
	ProductKey int NOT NULL,
	OrderDateKey int NOT NULL,
	DueDateKey int NOT NULL,
	ShipDateKey int NOT NULL,
	ResellerKey int NOT NULL,
	EmployeeKey int NOT NULL,
	PromotionKey int NOT NULL,
	CurrencyKey int NOT NULL,
	SalesTerritoryKey int NOT NULL,
	SalesOrderNumber nvarchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesOrderLineNumber tinyint NOT NULL,
	RevisionNumber tinyint NULL,
	OrderQuantity smallint NULL,
	UnitPrice money NULL,
	ExtendedAmount money NULL,
	UnitPriceDiscountPct float NULL,
	DiscountAmount float NULL,
	ProductStandardCost money NULL,
	TotalProductCost money NULL,
	SalesAmount money NULL,
	TaxAmt money NULL,
	Freight money NULL,
	CarrierTrackingNumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CustomerPONumber nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	OrderDate datetime NULL,
	DueDate datetime NULL,
	ShipDate datetime NULL,
	CONSTRAINT PK_FactResellerSales_SalesOrderNumber_SalesOrderLineNumber PRIMARY KEY (SalesOrderNumber,SalesOrderLineNumber)
);

/* --- DIMENSIONES REQUERIDAS (NUEVAS Y COMPARTIDAS) --- */

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimReseller (
	ResellerKey int IDENTITY(1,1) NOT NULL,
	GeographyKey int NULL,
	ResellerAlternateKey nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Phone nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	BusinessType varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ResellerName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	NumberEmployees int NULL,
	OrderFrequency char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	OrderMonth tinyint NULL,
	FirstOrderYear int NULL,
	LastOrderYear int NULL,
	ProductLine nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AddressLine1 nvarchar(60) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AddressLine2 nvarchar(60) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	AnnualSales money NULL,
	BankName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	MinPaymentType tinyint NULL,
	MinPaymentAmount money NULL,
	AnnualRevenue money NULL,
	YearOpened int NULL,
	CONSTRAINT AK_DimReseller_ResellerAlternateKey UNIQUE (ResellerAlternateKey),
	CONSTRAINT PK_DimReseller_ResellerKey PRIMARY KEY (ResellerKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimEmployee (
	EmployeeKey int IDENTITY(1,1) NOT NULL,
	ParentEmployeeKey int NULL,
	EmployeeNationalIDAlternateKey nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ParentEmployeeNationalIDAlternateKey nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SalesTerritoryKey int NULL,
	FirstName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	LastName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MiddleName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	NameStyle bit NOT NULL,
	Title nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	HireDate date NULL,
	BirthDate date NULL,
	LoginID nvarchar(256) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmailAddress nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Phone nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	MaritalStatus nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmergencyContactName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmergencyContactPhone nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SalariedFlag bit NULL,
	Gender nchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	PayFrequency tinyint NULL,
	BaseRate money NULL,
	VacationHours smallint NULL,
	SickLeaveHours smallint NULL,
	CurrentFlag bit NOT NULL,
	SalesPersonFlag bit NOT NULL,
	DepartmentName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	StartDate date NULL,
	EndDate date NULL,
	Status nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EmployeePhoto varbinary(MAX) NULL,
	CONSTRAINT PK_DimEmployee_EmployeeKey PRIMARY KEY (EmployeeKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimPromotion (
	PromotionKey int IDENTITY(1,1) NOT NULL,
	PromotionAlternateKey int NULL,
	EnglishPromotionName nvarchar(255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DiscountPct float NULL,
	EnglishPromotionType nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EnglishPromotionCategory nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	StartDate datetime NOT NULL,
	EndDate datetime NULL,
	MinQty int NULL,
	MaxQty int NULL,
	CONSTRAINT AK_DimPromotion_PromotionAlternateKey UNIQUE (PromotionAlternateKey),
	CONSTRAINT PK_DimPromotion_PromotionKey PRIMARY KEY (PromotionKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimCurrency (
	CurrencyKey int IDENTITY(1,1) NOT NULL,
	CurrencyAlternateKey nchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CurrencyName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	CONSTRAINT PK_DimCurrency_CurrencyKey PRIMARY KEY (CurrencyKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimSalesTerritory (
	SalesTerritoryKey int IDENTITY(1,1) NOT NULL,
	SalesTerritoryAlternateKey int NULL,
	SalesTerritoryRegion nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesTerritoryCountry nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	SalesTerritoryGroup nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CONSTRAINT AK_DimSalesTerritory_SalesTerritoryAlternateKey UNIQUE (SalesTerritoryAlternateKey),
	CONSTRAINT PK_DimSalesTerritory_SalesTerritoryKey PRIMARY KEY (SalesTerritoryKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimProduct (
	ProductKey int IDENTITY(1,1) NOT NULL,
	ProductAlternateKey nvarchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ProductSubcategoryKey int NULL,
	EnglishProductName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	StandardCost money NULL,
	FinishedGoodsFlag bit NOT NULL,
	Color nvarchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	ListPrice money NULL,
	[Size] nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	Weight float NULL,
	DaysToManufacture int NULL,
	ProductLine nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DealerPrice money NULL,
	Class nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[Style] nchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	ModelName nvarchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EnglishDescription nvarchar(400) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	StartDate datetime NULL,
	EndDate datetime NULL,
	Status nvarchar(7) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CONSTRAINT PK_DimProduct_ProductKey PRIMARY KEY (ProductKey)
);

CREATE TABLE AdventureWorksDW2022_DW.dbo.DimDate (
	DateKey int NOT NULL,
	FullDateAlternateKey date NOT NULL,
	EnglishDayNameOfWeek nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	DayNumberOfMonth tinyint NOT NULL,
	DayNumberOfYear smallint NOT NULL,
	WeekNumberOfYear tinyint NOT NULL,
	EnglishMonthName nvarchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	MonthNumberOfYear tinyint NOT NULL,
	CalendarQuarter tinyint NOT NULL,
	CalendarYear smallint NOT NULL,
	CalendarSemester tinyint NOT NULL,
	FiscalQuarter tinyint NOT NULL,
	FiscalYear smallint NOT NULL,
	FiscalSemester tinyint NOT NULL,
	CONSTRAINT PK_DimDate_DateKey PRIMARY KEY (DateKey)
);


[Contenido de `summary-resellerSales` (fuente: 1-25)]
Mi Petición (Lo que necesito de ti):

Análisis de Brecha (Gap Analysis):

Mira las dimensiones requeridas por FactResellerSales (basado en el DDL de destino).

Compara esas dimensiones con las que te dije que ya existen (DimProduct, DimDate, DimCustomer).

Haz una lista de las dimensiones que son compartidas (y que no necesito volver a crear, solo reutilizar).

Haz una lista de las dimensiones que son totalmente nuevas para este proyecto (ej. DimReseller, DimEmployee, DimPromotion, DimCurrency, DimSalesTerritory).

Generación de Scripts (Solo para lo nuevo):

Para cada dimensión NUEVA (como DimReseller, DimEmployee, etc.), générame los scripts de Python para extract, transform y load.

IMPORTANTE: Para las dimensiones COMPARTIDAS (como DimProduct y DimDate), no generes código nuevo. Asume que ya existen.

Generación de Scripts (Nueva Tabla de Hechos):

Générame los scripts extract, transform y load para la nueva tabla FactResellerSales. El script de transformación debe hacer el lookup (búsqueda de claves) contra todas sus dimensiones (DimProduct, DimDate, DimReseller, etc.).

Actualización del Orquestador (main.py):

Muéstrame cómo debo modificar mi archivo main.py para incluir la orquestación de estas nuevas tablas. El orden de carga es crucial:

Cargar todas las dimensiones (las viejas y las nuevas).

Cargar las tablas de hechos (la vieja FactInternetSales y la nueva FactResellerSales).

